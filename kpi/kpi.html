<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <!-- keep same viewport feel as landing page -->
  <meta name="viewport" content="width=device-width, initial-scale=1.5" />
  <title>Supertram Â· SHEQ KPI Dashboard</title>
  <meta name="description" content="SHEQ KPI dashboard for Safety Actions and Accident & Incident performance." />
  <link rel="icon" href="../STLogo.jpg" />
  <link rel="stylesheet" href="kpi.css" />

  <!-- Chart.js (CDN) -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1"></script>
</head>
<body>

  <!-- Top title bar -->
  <div class="topnav" role="navigation" aria-label="Top bar">
    <span class="title">SHEQ KPI Dashboard</span>
  </div>

  <!-- Hero header (optional background + logo) -->
  <header class="st-hero" role="banner" aria-label="Supertram SHEQ header">
    <div class="logo-wrap">
      <img class="st-logo" src="../STLogo.jpg" alt="Supertram â€“ SHEQ" />
    </div>
  </header>

  <!-- Main -->
  <main class="container">

    <!-- Filters -->
    <section class="filters card">
      <h2>Filters</h2>
      <div class="filters-row">
        <div class="field">
          <label for="periodSelect">Reporting Period</label>
          <select id="periodSelect">
            <option value="">All Periods</option>
          </select>
        </div>

        <div class="field">
          <label>Custom Date Range</label>
          <div class="dates">
            <input type="date" id="startDate" />
            <span>to</span>
            <input type="date" id="endDate" />
          </div>
        </div>

        <div class="field">
          <label for="deptSelect">Department / Function</label>
          <select id="deptSelect">
            <option value="">All</option>
          </select>
        </div>

        <div class="field right">
          <button id="resetBtn" class="btn secondary">Reset</button>
          <button id="applyBtn" class="btn">Apply</button>
        </div>
      </div>
    </section>

    <!-- KPI tiles -->
    <section aria-label="Headline KPIs" class="kpis-grid">

      <!-- Safety actions -->
      <div class="kpi card">
        <div class="kpi-title"><span class="kpi-icon" aria-hidden="true">ğŸ“</span> Actions â€” Total</div>
        <div class="kpi-num" id="sa_total">â€“</div>
        <div class="kpi-trend" id="sa_total_trend" aria-live="polite"></div>

        <div class="kpi-sub">
          <span class="kpi-closed"><span id="sa_closed">â€“</span> closed</span> Â·
          <span class="kpi-open"><span id="sa_open">â€“</span> open</span> Â·
          <span class="kpi-overdue"><span id="sa_overdue">â€“</span> overdue</span>
        </div>
      </div>

      <div class="kpi card">
        <div class="kpi-title"><span class="kpi-icon" aria-hidden="true">âœ”ï¸</span> % Actions Closed</div>
        <div class="kpi-num" id="sa_pct_closed">â€“</div>
        <div class="kpi-trend" id="sa_pct_closed_trend" aria-live="polite"></div>

        <div class="kpi-sub">Closed vs raised in period</div>
      </div>

      <div class="kpi card">
        <div class="kpi-title"><span class="kpi-icon" aria-hidden="true">ğŸ•’</span> Avg Days to Close</div>
        <div class="kpi-num" id="sa_avg_days">â€“</div>
        <div class="kpi-trend" id="sa_avg_days_trend" aria-live="polite"></div>

        <div class="kpi-sub">Closed actions only</div>
      </div>

      <div class="kpi card">
        <div class="kpi-title"><span class="kpi-icon" aria-hidden="true">ğŸ¯</span> Action SLA (On-time)</div>
        <div class="kpi-num" id="sa_sla">â€“</div>
        <div class="kpi-trend" id="sa_sla_trend" aria-live="polite"></div>

        <div class="kpi-sub">Completed â‰¤ Target date</div>
      </div>

      <!-- Incidents -->
      <div class="kpi card">
        <div class="kpi-title"><span class="kpi-icon" aria-hidden="true">ğŸ’¥</span> Incidents â€” Total</div>
        <div class="kpi-num" id="inc_total">â€“</div>
        <div class="kpi-trend" id="inc_total_trend" aria-live="polite"></div>

        <div class="kpi-sub">
          <span class="kpi-closed"><span id="inc_closed">â€“</span> closed</span> Â·
          <span class="kpi-open"><span id="inc_open">â€“</span> open</span> Â·
          <span class="kpi-overdue"><span id="inc_overdue">â€“</span> overdue inv.</span>
        </div>
      </div>

      <div class="kpi card">
        <div class="kpi-title"><span class="kpi-icon" aria-hidden="true">âš¡</span> RIDDOR</div>
        <div class="kpi-num" id="inc_riddor">â€“</div>
        <div class="kpi-trend" id="inc_riddor_trend" aria-live="polite"></div>

        <div class="kpi-sub">Count in period</div>
      </div>

      <div class="kpi card">
        <div class="kpi-title"><span class="kpi-icon" aria-hidden="true">â›‘</span> Days Lost</div>
        <div class="kpi-num" id="inc_dayslost">â€“</div>
        <div class="kpi-trend" id="inc_dayslost_trend" aria-live="polite"></div>

        <div class="kpi-sub">Sum of reported days</div>
      </div>

      <div class="kpi card">
        <div class="kpi-title"><span class="kpi-icon" aria-hidden="true">ğŸ”</span> Investigation SLA</div>
        <div class="kpi-num" id="inc_sla">â€“</div>
        <div class="kpi-trend" id="inc_sla_trend" aria-live="polite"></div>

        <div class="kpi-sub">Completed â‰¤ Due date</div>
      </div>
    </section>

    <!-- Charts row -->
    <section class="charts-grid">
      <div class="card">
        <h3>Actions by Type</h3>
        <canvas id="chartActionsByType" height="140"></canvas>
      </div>
      <div class="card">
        <h3>Actions by Department</h3>
        <canvas id="chartActionsByDept" height="140"></canvas>
      </div>
      <div class="card">
        <h3>Incidents by Type</h3>
        <canvas id="chartIncidentsByType" height="140"></canvas>
      </div>
      <div class="card">
        <h3>Incidents by Function</h3>
        <canvas id="chartIncidentsByFunction" height="140"></canvas>
      </div>
    </section>

    <!-- Drilldown tables -->
    <section class="tables-grid">
      <div class="card">
        <h3>Open / Overdue Actions</h3>
        <table class="table" id="tblActions">
          <thead>
            <tr>
              <th>Status</th>
              <th>Type</th>
              <th>Dept</th>
              <th>Owner</th>
              <th>Raised</th>
              <th>Target</th>
              <th>Completed</th>
              <th>Comments</th>
            </tr>
          </thead>
          <tbody><!-- filled by JS --></tbody>
        </table>
      </div>

      <div class="card">
        <h3>Open / Overdue Investigations</h3>
        <table class="table" id="tblIncidents">
          <thead>
            <tr>
              <th>Status</th>
              <th>Incident Type</th>
              <th>Function</th>
              <th>Date</th>
              <th>Due</th>
              <th>Completed</th>
              <th>RIDDOR</th>
              <th>Days Lost</th>
            </tr>
          </thead>
          <tbody><!-- filled by JS --></tbody>
        </table>
      </div>
    </section>

  </main>

  <footer>
    Â© Sheffield Supertram â€” Safety â€¢ Health â€¢ Environment â€¢ Quality
  </footer>

  <!-- App JS -->
  <script src="kpi.js"></script>
</body>
</html>
